var W=Object.defineProperty;var j=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var G=(a,e,t)=>e in a?W(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,J=(a,e)=>{for(var t in e||(e={}))X.call(e,t)&&G(a,t,e[t]);if(j)for(var t of j(e))Z.call(e,t)&&G(a,t,e[t]);return a};import{S as x,i as $,s as ee,e as m,c as h,a as y,d as _,b as o,g as A,G as s,H as Q,F as te,t as T,k as U,h as D,m as C,f as z,Q as q,J as R,j as V,R as K}from"../../chunks/vendor-9f39b42c.js";import{h as re}from"../../chunks/http-7001acd5.js";import"../../chunks/singletons-d1fb5791.js";function se(a){let e,t,f,b,r,n,d,l,N,v,I,F,c,p,w,P,L,k,S,E,u;return{c(){e=m("form"),t=m("h1"),f=T("Change Password"),b=U(),r=m("label"),n=T("New Password"),d=U(),l=m("input"),N=U(),v=m("label"),I=T("Confirm Password"),F=U(),c=m("input"),p=U(),w=m("div"),P=T(a[3]),L=U(),k=m("button"),S=T("Update Password"),this.h()},l(g){e=h(g,"FORM",{class:!0});var i=y(e);t=h(i,"H1",{class:!0});var B=y(t);f=D(B,"Change Password"),B.forEach(_),b=C(i),r=h(i,"LABEL",{for:!0,class:!0});var H=y(r);n=D(H,"New Password"),H.forEach(_),d=C(i),l=h(i,"INPUT",{placeholder:!0,type:!0,class:!0}),N=C(i),v=h(i,"LABEL",{for:!0,class:!0});var O=y(v);I=D(O,"Confirm Password"),O.forEach(_),F=C(i),c=h(i,"INPUT",{placeholder:!0,type:!0,class:!0}),p=C(i),w=h(i,"DIV",{class:!0});var M=y(w);P=D(M,a[3]),M.forEach(_),L=C(i),k=h(i,"BUTTON",{type:!0,style:!0,class:!0});var Y=y(k);S=D(Y,"Update Password"),Y.forEach(_),i.forEach(_),this.h()},h(){o(t,"class","svelte-19mtr7l"),o(r,"for","username"),o(r,"class","svelte-19mtr7l"),o(l,"placeholder","Username\u30FBEmail"),o(l,"type","text"),l.required=!0,o(l,"class","input input--normal input--white"),o(v,"for","username"),o(v,"class","svelte-19mtr7l"),o(c,"placeholder","Username\u30FBEmail"),o(c,"type","text"),c.required=!0,o(c,"class","input input--normal input--white"),o(w,"class","error error--center"),o(k,"type","submit"),z(k,"width","100%"),o(k,"class","button button--normal button--primary button--very-round"),o(e,"class","forgotten-page__card svelte-19mtr7l")},m(g,i){A(g,e,i),s(e,t),s(t,f),s(e,b),s(e,r),s(r,n),s(e,d),s(e,l),q(l,a[2].password),s(e,N),s(e,v),s(v,I),s(e,F),s(e,c),q(c,a[2].confirm_password),s(e,p),s(e,w),s(w,P),s(e,L),s(e,k),s(k,S),E||(u=[R(l,"input",a[9]),R(c,"input",a[10]),R(e,"submit",a[5])],E=!0)},p(g,i){i&4&&l.value!==g[2].password&&q(l,g[2].password),i&4&&c.value!==g[2].confirm_password&&q(c,g[2].confirm_password),i&8&&V(P,g[3])},d(g){g&&_(e),E=!1,K(u)}}}function ae(a){let e,t,f,b,r,n,d,l,N,v,I,F,c,p,w,P,L,k,S;return{c(){e=m("form"),t=m("h1"),f=T("Forgotten Password"),b=U(),r=m("label"),n=T("Your Username\u30FBEmail"),d=U(),l=m("input"),N=U(),v=m("div"),I=T(a[3]),F=U(),c=m("div"),p=T(a[4]),w=U(),P=m("button"),L=T("Send Reset Email"),this.h()},l(E){e=h(E,"FORM",{class:!0});var u=y(e);t=h(u,"H1",{class:!0});var g=y(t);f=D(g,"Forgotten Password"),g.forEach(_),b=C(u),r=h(u,"LABEL",{for:!0,class:!0});var i=y(r);n=D(i,"Your Username\u30FBEmail"),i.forEach(_),d=C(u),l=h(u,"INPUT",{placeholder:!0,type:!0,class:!0}),N=C(u),v=h(u,"DIV",{class:!0});var B=y(v);I=D(B,a[3]),B.forEach(_),F=C(u),c=h(u,"DIV",{class:!0});var H=y(c);p=D(H,a[4]),H.forEach(_),w=C(u),P=h(u,"BUTTON",{type:!0,style:!0,class:!0});var O=y(P);L=D(O,"Send Reset Email"),O.forEach(_),u.forEach(_),this.h()},h(){o(t,"class","svelte-19mtr7l"),o(r,"for","username"),o(r,"class","svelte-19mtr7l"),o(l,"placeholder","Username\u30FBEmail"),o(l,"type","text"),l.required=!0,o(l,"class","input input--normal input--white"),o(v,"class","error error--center"),o(c,"class","forgotten-page__success"),o(P,"type","submit"),z(P,"width","100%"),o(P,"class","button button--normal button--primary button--very-round"),o(e,"class","forgotten-page__card svelte-19mtr7l")},m(E,u){A(E,e,u),s(e,t),s(t,f),s(e,b),s(e,r),s(r,n),s(e,d),s(e,l),q(l,a[1].credential),s(e,N),s(e,v),s(v,I),s(e,F),s(e,c),s(c,p),s(e,w),s(e,P),s(P,L),k||(S=[R(l,"input",a[8]),R(e,"submit",a[6])],k=!0)},p(E,u){u&2&&l.value!==E[1].credential&&q(l,E[1].credential),u&8&&V(I,E[3]),u&16&&V(p,E[4])},d(E){E&&_(e),k=!1,K(S)}}}function le(a){let e,t;function f(n,d){return n[0]?se:ae}let b=f(a),r=b(a);return{c(){e=m("div"),t=m("div"),r.c(),this.h()},l(n){e=h(n,"DIV",{class:!0});var d=y(e);t=h(d,"DIV",{class:!0});var l=y(t);r.l(l),l.forEach(_),d.forEach(_),this.h()},h(){o(t,"class","forgotten-page__container container"),o(e,"class","forgotten-page page svelte-19mtr7l")},m(n,d){A(n,e,d),s(e,t),r.m(t,null)},p(n,[d]){b===(b=f(n))&&r?r.p(n,d):(r.d(1),r=b(n),r&&(r.c(),r.m(t,null)))},i:Q,o:Q,d(n){n&&_(e),r.d()}}}const de=async({session:a,url:e,fetch:t})=>{if(a.authenticated)return{redirect:"/",status:302};{let f="";return e.searchParams.get("token")&&(f=e.searchParams.get("token")),{props:{token:f}}}};function oe(a,e,t){let f={credential:""},{token:b=""}=e,r={password:"",confirm_password:""},n="",d="",{verified:l=""}=e;te("store");async function N(p){if(p.preventDefault(),r.password!=r.confirm_password)return t(3,n="Confirm Password is different from Password")}async function v(p){p.preventDefault(),t(4,d="");const w=await re(fetch)("/auth/reset/request","POST",J({},f));if(w!=null&&w.error){t(3,n=w.error);return}t(4,d="Sent Confirmation Email to Associated User's email")}function I(){f.credential=this.value,t(1,f)}function F(){r.password=this.value,t(2,r)}function c(){r.confirm_password=this.value,t(2,r)}return a.$$set=p=>{"token"in p&&t(0,b=p.token),"verified"in p&&t(7,l=p.verified)},[b,f,r,n,d,N,v,l,I,F,c]}class fe extends x{constructor(e){super();$(this,e,oe,le,ee,{token:0,verified:7})}}export{fe as default,de as load};
